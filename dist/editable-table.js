parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"w9XJ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e={type:"button",onEdit:function(e,t,l,a,n){return null!=t.callback&&t.callback(l,a),!1},onUpdateCell:function(e,t,l,a,n){var c=document.createElement("div"),d=document.createTextNode(e.params.bodies[a][l]);return c.addEventListener("click",function(){e.setCursor(l,a,!1),null!=t.callback&&t.callback(l,a)},!1),c.appendChild(d),n.appendChild(c),!1}};exports.default=e;
},{}],"Hb4X":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e={type:"link",onEdit:function(e,t,r,a,d){return d.firstChild.click(),!1},onUpdateCell:function(e,t,r,a,d){var i=document.createElement("a");i.setAttribute("href",e.params.bodies[a][r]),i.setAttribute("target","_blank"),i.setAttribute("rel","noreferrer");var n=document.createTextNode(e.params.bodies[a][r]);return i.appendChild(n),d.appendChild(i),!1}};exports.default=e;
},{}],"JS4L":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t={type:"select",onSetup:function(t){this.listboxNode=null,this.listboxSelectedIndex=0,this.setupLlistbox(t)},onClick:function(t,e,s){s.closest(".editable-table__listbox")||this.closeListbox(t)},onEdit:function(t,e,s,o,i){this.listboxSelectedIndex=0;for(var l=0;l<e.options.length;l++)if(e.options[l]===t.params.bodies[o][s]){this.listboxSelectedIndex=l;break}return e.options.length>0&&this.openListbox(t,i,e.options),!1},onKeyDown:function(t,e,s){if("Listbox"===t.focusType){var o=t.getExtension(t.cursor.x);switch(s){case"ArrowUp":event.preventDefault(),this.addListboxSelectedIndex(t,-1,o.options);break;case"ArrowDown":event.preventDefault(),this.addListboxSelectedIndex(t,1,o.options);break;case"Tab":event.preventDefault(),this.closeListbox(t),event.shiftKey?t.setCursorToLeft():t.setCursorToRight();break;case" ":case"Space":event.preventDefault(),this.updateListboxToCell(t,t.cursor.x,t.cursor.y),this.closeListbox(t);break;case"Escape":this.closeListbox(t)}}},onKeyUp:function(t,e,s){if("Listbox"===t.focusType)switch(s){case"Enter":this.updateListboxToCell(t,t.cursor.x,t.cursor.y),this.closeListbox(t),t.setCursorToDown()}},onPasteCell:function(t,e,s,o){return-1!==e.options.indexOf(t.clipboard.value)},setupLlistbox:function(t){this.listboxNode=document.createElement("ol"),this.listboxNode.setAttribute("class","editable-table__listbox"),this.listboxNode.style.display="none",t.containerNode.appendChild(this.listboxNode)},openListbox:function(t,e,s){var o=this.updateListboxChildren(t,s);this.adjustListboxIntoView(t,e),t.scrollIntoView(this.listboxNode,o,0,0),t.setFocus("Listbox")},updateListboxChildren:function(t,e){var s=this,o=null;this.listboxNode.innerHTML="";for(var i=function(i){var l=document.createElement("li"),n=document.createTextNode(e[i]);i===s.listboxSelectedIndex&&(o=l),l.setAttribute("data-selected",i===s.listboxSelectedIndex),l.addEventListener("click",function(e){s.listboxSelectedIndex=i,s.updateListboxToCell(t,t.cursor.x,t.cursor.y),s.closeListbox(t)},!1),l.appendChild(n),s.listboxNode.appendChild(l)},l=0;l<e.length;l++)i(l);return o},closeListbox:function(t){this.listboxNode.style.display="none",t.setFocus("Table")},addListboxSelectedIndex:function(t,e,s){this.listboxNode.children[this.listboxSelectedIndex].setAttribute("data-selected","false"),this.listboxSelectedIndex+=e,this.listboxSelectedIndex=Math.max(0,Math.min(s.length-1,this.listboxSelectedIndex)),this.listboxNode.children[this.listboxSelectedIndex].setAttribute("data-selected","true"),t.scrollIntoView(this.listboxNode,this.listboxNode.children[this.listboxSelectedIndex],0,0)},updateListboxToCell:function(t,e,s){var o=t.getExtension(e).options[this.listboxSelectedIndex];t.params.bodies[s][e]=o,t.updateCell(e,s)},adjustListboxIntoView:function(t,e){this.listboxNode.style.opacity="0",this.listboxNode.style.display="",this.listboxNode.style["max-height"]="";var s=e.getBoundingClientRect(),o=s.left,i=s.top,l=Math.min(this.listboxNode.clientHeight,document.documentElement.clientHeight)-2*(t.params.listboxMargin||0);i-=Math.abs(Math.min(document.documentElement.clientHeight-(i+l+(t.params.listboxMargin||0)),0)),this.listboxNode.style.left="".concat(o,"px"),this.listboxNode.style.top="".concat(i,"px"),this.listboxNode.style["max-height"]="".concat(l,"px"),this.listboxNode.style.opacity=""}};exports.default=t;
},{}],"IsZn":[function(require,module,exports) {
"use strict";var e=i(require("./src/button.js")),t=i(require("./src/link.js")),s=i(require("./src/select.js"));function i(e){return e&&e.__esModule?e:{default:e}}function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function o(e,t,s){return t&&n(e.prototype,t),s&&n(e,s),e}var l=function(){function i(a){r(this,i),this.params=a,this.setupProperties(),this.params.extensions.push(e.default),this.params.extensions.push(t.default),this.params.extensions.push(s.default),this.setupTable(),this.setupListeners(),this.callExtension("all","onSetup")}return o(i,[{key:"setupProperties",value:function(){this.focusType=this.params.autofocus?"Table":"None",this.params.columnRegulations=this.params.columnRegulations||[],this.params.extensions=this.params.extensions||[],this.containerNode=null,this.scrollerNode=null,this.tableNode=null,this.theadNode=null,this.tbodyNode=null,this.cursor={x:0,y:0},this.isInputting=!1,this.clipboard={type:null,extension:null,value:null}}},{key:"setupTable",value:function(){this.containerNode=document.createElement("div"),this.containerNode.setAttribute("class","editable-table"),this.scrollerNode=document.createElement("div"),this.scrollerNode.setAttribute("class","editable-table__scroller"),this.tableNode=document.createElement("table"),this.theadNode=document.createElement("thead"),this.tbodyNode=document.createElement("tbody"),this.setHeaders(this.params.headers),this.setHeaderSpans(this.params.headerSpans),this.setBodies(this.params.bodies),this.tableNode.appendChild(this.theadNode),this.tableNode.appendChild(this.tbodyNode),this.scrollerNode.appendChild(this.tableNode),this.containerNode.appendChild(this.scrollerNode),this.params.containerNode.appendChild(this.containerNode),this.updateHeaderPositions(),this.setFocus(this.focusType)}},{key:"getWidth",value:function(){return null==this.params.bodies?0:this.params.bodies.length>0?this.params.bodies[0].length:0}},{key:"getHeight",value:function(){return null==this.params.bodies?0:this.params.bodies.length}},{key:"getExtension",value:function(e,t){return null!=this.params.columnRegulations&&null!=this.params.columnRegulations[e]&&null!=this.params.columnRegulations[e].extension?this.params.columnRegulations[e].extension:{type:null}}},{key:"getFilter",value:function(e,t){return null!=this.params.columnRegulations&&null!=this.params.columnRegulations[e]&&null!=this.params.columnRegulations[e].filter?this.params.columnRegulations[e].filter:""}},{key:"isDisabled",value:function(e,t){return null!=this.params.columnRegulations&&null!=this.params.columnRegulations[e]&&null!=this.params.columnRegulations[e].disabled&&this.params.columnRegulations[e].disabled}},{key:"setHeaders",value:function(e){if(this.theadNode.innerHTML="",null!=e&&e.length>0){for(var t=null,s=0;s<e.length;s++){var i=document.createElement("tr");0===s&&"none"!==this.params.bodyHeaderType&&(t=this.appendHeader(i,""));for(var a=0;a<e[s].length;a++)this.appendHeader(i,e[s][a]);this.theadNode.appendChild(i)}null!==t&&t.setAttribute("rowspan","2")}}},{key:"appendHeader",value:function(e,t){var s=document.createElement("th"),i=document.createTextNode(t);return s.appendChild(i),e.appendChild(s),s}},{key:"setHeaderSpans",value:function(e){if(null!=e&&null!=this.params.headers)for(var t=0;t<this.params.headers.length;t++)for(var s=0;s<this.params.headers[t].length;s++)null!=e[t]&&null!=e[t][s]&&(null!=e[t][s].x&&this.setHeaderAttribute(s,t,"colspan",e[t][s].x),null!=e[t][s].y&&this.setHeaderAttribute(s,t,"rowspan",e[t][s].y))}},{key:"setHeaderAttribute",value:function(e,t,s,i){this.theadNode.children[t].children[e+("none"!==this.params.bodyHeaderType?1:0)].setAttribute(s,i)}},{key:"updateHeaderPositions",value:function(){for(var e=0,t=this.theadNode.children,s=0;s<t.length;s++){for(var i=t[s].children,a=0;a<i.length;a++)i[a].style.top="".concat(e,"px");s<t.length-1&&(e+=t[s].clientHeight)}}},{key:"setBodies",value:function(e){var t=this.getHeight();this.tbodyNode.innerHTML="";for(var s=0;s<t;s++)this.appendBodyRow(s);this.setCursor(0,0)}},{key:"appendBodyData",value:function(e){this.params.bodies.push(e)}},{key:"appendBodyRow",value:function(e){var t=document.createElement("tr");if("none"!==this.params.bodyHeaderType){var s="value"===this.params.bodyHeaderType?this.params.bodies[e][0]:e+1;this.appendBodyHeader(t,e,s)}for(var i="value"===this.params.bodyHeaderType?1:0;i<this.params.bodies[e].length;i++){var a=document.createElement("td");this.updateCell(i,e,a),a.setAttribute("data-x",i),a.setAttribute("data-y",e),t.appendChild(a)}this.tbodyNode.appendChild(t)}},{key:"appendBodyHeader",value:function(e,t,s){var i=document.createElement("th"),a=document.createTextNode(s);i.setAttribute("data-y",t),i.appendChild(a),e.appendChild(i)}},{key:"updateCell",value:function(e,t,s){if(s||(s=this.tableNode.querySelector('[data-x="'.concat(e,'"][data-y="').concat(t,'"]'))),s){var i=this.params.bodies[t][e],r=null==i?"number":a(i),n=this.isDisabled(e),o=this.getExtension(e);if(s.setAttribute("data-type",r),s.setAttribute("data-cursor",e===this.cursor.x&&t===this.cursor.y),s.setAttribute("data-disabled",n),s.setAttribute("data-extension",o.type||""),s.innerHTML="",!this.callExtension(o,"onUpdateCell",e,t,s))if("boolean"===r)s.setAttribute("data-checked",i.toString());else if(null!=i){var l=this.params.filters[this.getFilter(e)],u=null!=l?l(i):i,h=document.createTextNode(u);s.appendChild(h)}}}},{key:"setCellValue",value:function(e,t,s){var i=this.tableNode.querySelector('[data-x="'.concat(e,'"][data-y="').concat(t,'"]')),a=i.getAttribute("data-type"),r="boolean"===a?Boolean(s):"number"===a?""===s?null:Number(s):s;this.params.bodies[t][e]=r,this.updateCell(e,t,i)}},{key:"setFocus",value:function(e){this.focusType=e,this.containerNode.setAttribute("data-focus","Table"===this.focusType)}},{key:"setInputting",value:function(e){this.isInputting=e,this.containerNode.setAttribute("data-inputting",this.isInputting)}},{key:"setupListeners",value:function(){window.addEventListener("click",this.onClick.bind(this),!1),window.addEventListener("dblclick",this.onDoubleClick.bind(this),!1),window.addEventListener("keydown",this.onKeyDown.bind(this),!1),window.addEventListener("keyup",this.onKeyUp.bind(this),!1),window.addEventListener("resize",this.onResize.bind(this),!1)}},{key:"edit",value:function(e,t,s){var i=this;if(!this.isInputting){var a=this.tableNode.querySelector('[data-x="'.concat(e,'"][data-y="').concat(t,'"]'));if(a&&!this.isDisabled(e)){var r=a.getAttribute("data-type"),n=this.getExtension(e);if(!this.callExtension(n,"onEdit",e,t,a))if("boolean"===r)this.params.bodies[t][e]=!this.params.bodies[t][e],this.updateCell(e,t);else{this.setInputting(!0),this.setFocus("None"),a.innerHTML="";var o=null;"number"===r?((o=document.createElement("input")).setAttribute("size","1"),o.setAttribute("spellcheck","false"),o.setAttribute("type","text"),o.setAttribute("value",null==this.params.bodies[t][e]?"":this.params.bodies[t][e]),a.appendChild(o)):((o=document.createElement("textarea")).setAttribute("cols","1"),o.setAttribute("rows","1"),o.setAttribute("spellcheck","false"),o.setAttribute("wrap","off"),o.value=this.params.bodies[t][e],a.appendChild(o)),this.resizeNodeToFitContent(o),o.addEventListener("keydown",function(){setTimeout(function(){i.resizeNodeToFitContent(o)},0)},!1);var l=!1;if(o.addEventListener("keydown",function(s){var a=s.code||s.key;if(s.isComposing)"Enter"===a&&(l=!0);else switch(a){case"Enter":if("string"===r&&(s.preventDefault(),s.ctrlKey||s.metaKey)){var n=o.selectionStart,u=o.value.substr(0,n),h=o.value.substr(n,o.value.length);o.value=u+"\n"+h,o.setSelectionRange(n+1,n+1)}break;case"Tab":s.preventDefault(),s.stopPropagation(),i.setFocus("Table"),i.setInputting(!1),i.setCellValue(e,t,o.value),s.shiftKey?i.setCursorToLeft():i.setCursorToRight();break;case"Escape":s.stopPropagation(),i.setFocus("Table"),i.setInputting(!1),i.updateCell(e,t)}},!1),o.addEventListener("keyup",function(s){switch(s.code||s.key){case"Enter":l||s.ctrlKey||s.metaKey||(s.preventDefault(),s.stopPropagation(),i.setFocus("Table"),i.setInputting(!1),i.setCellValue(e,t,o.value),i.setCursorToDown()),l&&(l=!1)}},!1),o.addEventListener("blur",function(s){i.setFocus("Table"),i.setInputting(!1),i.updateCell(e,t)},!1),s)o.addEventListener("focus",o.select,!1);else{var u=String(this.params.bodies[t][e]).length;o.setSelectionRange(u,u)}o.focus(),this.callExtension(n,"onEditPrepared",e,t,a,o)}}}}},{key:"resizeNodeToFitContent",value:function(e){e.parentNode&&(e.style.width="auto",e.style.width="".concat(Math.max(e.scrollWidth,e.parentNode.clientWidth)+32,"px"),e.style.height="auto",e.style.height="".concat(Math.max(e.scrollHeight,e.parentNode.clientHeight),"px"))}},{key:"setCursor",value:function(e,t){var s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(null==e&&(e=this.getWidth()-1),null==t&&(t=this.getHeight()-1),this.isCursorValid(e,t)){var i=this.tableNode.querySelector('[data-cursor="true"]');i&&i.setAttribute("data-cursor","false");var a=this.tableNode.querySelector('[data-x="'.concat(e,'"][data-y="').concat(t,'"]'));if(a){if(a.setAttribute("data-cursor","true"),s){var r=this.tbodyNode.querySelector("tr th"),n=null!==r?r.clientWidth:0,o=this.theadNode.clientHeight;this.scrollIntoView(this.scrollerNode,a,n,o)}this.cursor.x=e,this.cursor.y=t}}}},{key:"scrollIntoView",value:function(e,t){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(null!=e&&null!=t){var a=e.scrollLeft,r=e.clientWidth,n=t.offsetLeft,o=t.clientWidth,l=e.scrollTop,u=e.clientHeight,h=t.offsetTop,c=t.clientHeight;a>n-s?e.scrollLeft=n-s:a+r<n+o&&(e.scrollLeft=n+o-r),l>h-i?e.scrollTop=h-i:l+u<h+c&&(e.scrollTop=h+c-u)}}},{key:"setCursorToLeft",value:function(){this.setCursor(this.cursor.x-1,this.cursor.y)}},{key:"setCursorToRight",value:function(){this.setCursor(this.cursor.x+1,this.cursor.y)}},{key:"setCursorToUp",value:function(){this.setCursor(this.cursor.x,this.cursor.y-1)}},{key:"setCursorToDown",value:function(){this.setCursor(this.cursor.x,this.cursor.y+1)}},{key:"setCursorToLeftEnd",value:function(){var e="value"===this.params.bodyHeaderType?1:0;this.setCursor(e,this.cursor.y)}},{key:"setCursorToRightEnd",value:function(){this.setCursor(this.getWidth()-1,this.cursor.y)}},{key:"setCursorToTop",value:function(){this.setCursor(this.cursor.x,0)}},{key:"setCursorToBottom",value:function(){this.setCursor(this.cursor.x,this.getHeight()-1)}},{key:"isCursorValid",value:function(e,t){return e>=("value"===this.params.bodyHeaderType?1:0)&&t>=0&&e<this.getWidth()&&t<this.getHeight()}},{key:"onClick",value:function(e){if(this.callExtension("all","onClick",e.target),e.target.closest(".editable-table")){if(this.setFocus("Table"),e.target.closest("td")){var t=parseInt(e.target.getAttribute("data-x"),10),s=parseInt(e.target.getAttribute("data-y"),10);this.setCursor(t,s,!1)}}else this.setFocus("None")}},{key:"onDoubleClick",value:function(e){"Table"===this.focusType&&e.target.closest("td")&&this.edit(this.cursor.x,this.cursor.y,!1)}},{key:"onKeyDown",value:function(e){var t=e.code||e.key;if("Table"===this.focusType)if(this.isCursorValid(this.cursor.x,this.cursor.y)){var s=a(this.params.bodies[this.cursor.y][this.cursor.x]),i=this.getExtension(this.cursor.x);switch(t){case"ArrowLeft":e.preventDefault(),e.ctrlKey||e.metaKey?this.setCursorToLeftEnd():this.setCursorToLeft();break;case"ArrowRight":e.preventDefault(),e.ctrlKey||e.metaKey?this.setCursorToRightEnd():this.setCursorToRight();break;case"ArrowUp":e.preventDefault(),e.ctrlKey||e.metaKey?this.setCursorToTop():this.setCursorToUp();break;case"ArrowDown":e.preventDefault(),e.ctrlKey||e.metaKey?this.setCursorToBottom():this.setCursorToDown();break;case"Tab":e.preventDefault(),e.shiftKey?this.setCursorToLeft():this.setCursorToRight();break;case" ":case"Space":e.preventDefault(),this.edit(this.cursor.x,this.cursor.y,"boolean"!==s);break;case"Backspace":e.preventDefault(),null==i.type&&this.setCellValue(this.cursor.x,this.cursor.y,"");break;case"Escape":e.preventDefault(),this.setFocus("None");break;case"KeyC":e.ctrlKey||e.metaKey?(e.preventDefault(),this.copyCell(this.cursor.x,this.cursor.y,s,i)):this.onEtceteraKeyDown(s,i,e);break;case"KeyV":e.ctrlKey||e.metaKey?(e.preventDefault(),this.pasteCell(this.cursor.x,this.cursor.y,s,i)):this.onEtceteraKeyDown(s,i,e);break;default:this.onEtceteraKeyDown(s,i,e)}}else switch(t){case"Escape":e.preventDefault(),this.setFocus("None")}else this.callExtension("all","onKeyDown",t)}},{key:"onEtceteraKeyDown",value:function(e,t,s){if("boolean"!==e&&null==t.type&&1===s.key.length){var i=s.key.charCodeAt(0);if(i>=32&&i<=126)return void this.edit(this.cursor.x,this.cursor.y,!0)}}},{key:"onKeyUp",value:function(e){var t=e.code||e.key;if("Table"===this.focusType)switch(t){case"Enter":this.edit(this.cursor.x,this.cursor.y,!1)}else this.callExtension("all","onKeyUp",t)}},{key:"copyCell",value:function(e,t,s,i){this.callExtension(i,"onCopyCell",e,t)||(this.clipboard.type=s,this.clipboard.extension=i,this.clipboard.value=this.params.bodies[t][e])}},{key:"pasteCell",value:function(e,t,s,i){this.clipboard.type===s&&this.clipboard.extension.type===i.type&&(this.callExtension(i,"onPasteCell",e,t)||this.isDisabled(e)||(this.params.bodies[t][e]=this.clipboard.value,this.updateCell(e,t)))}},{key:"onResize",value:function(){this.updateHeaderPositions()}},{key:"callExtension",value:function(e,t){for(var s=arguments.length,i=new Array(s>2?s-2:0),a=2;a<s;a++)i[a-2]=arguments[a];for(var r=0;r<this.params.extensions.length;r++){var n;if(("all"===e||this.params.extensions[r].type===e.type)&&null!=this.params.extensions[r][t])if(!(n=this.params.extensions[r])[t].apply(n,[this,e].concat(i)))return!0}return!1}}]),i}();module.exports=l;
},{"./src/button.js":"w9XJ","./src/link.js":"Hb4X","./src/select.js":"JS4L"}]},{},["IsZn"], "EditableTable")